webpackJsonp([8],{"6QlG":function(t,e){},"N1/l":function(t,e){},NmtU:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=r("Xxa5"),s=r.n(a),n=r("exGp"),i=r.n(n),o=r("GCuT"),l=r("gyMJ"),c=r("Nb9Q"),u=r("XZCL"),h={name:"QuartzEdit",components:{ISimpleBtnTriggerModal:r("I1g2").a},data:function(){return{formValidate:{id:0,task_name:"",task_type:"",cron_str:""},ruleValidate:{task_name:[{required:!0,message:"任务名称不能为空!",trigger:"blur"}],task_type:[{required:!0,message:"任务类型不能为空!",trigger:"blur"}],cron_str:[{validator:function(t,e,r){""===e?r(new Error("cron表达式不能为空!")):Object(o.n)(e)?r():r(new Error("cron表达式格式错误!"))},trigger:"blur"}]}}},methods:{handleSubmit:function(t){var e,r=this;this.$refs[t].validate((e=i()(s.a.mark(function t(e){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e){t.next=5;break}return t.next=3,Object(l.r)(r.formValidate);case 3:"SUCCESS"===t.sent.status?(r.$Message.success("提交成功!"),r.$refs.triggerModal.hideModal(),r.$emit("handleSuccess")):r.$Message.error("提交失败!");case 5:case"end":return t.stop()}},t,r)})),function(t){return e.apply(this,arguments)}))},handleReset:function(t){this.formValidate.id=0,this.$refs[t].resetFields()},initData:function(t){this.formValidate=t,this.$refs.triggerModal.triggerClick()}}},d={render:function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("ISimpleBtnTriggerModal",{ref:"triggerModal",attrs:{"btn-text":"新增","modal-title":"新增调度指令","modal-width":600}},[r("Form",{ref:"formValidate",attrs:{model:t.formValidate,rules:t.ruleValidate,"label-width":100}},[r("FormItem",{attrs:{label:"任务名称",prop:"task_name"}},[r("Input",{attrs:{placeholder:"任务名称目前版本需要和流程名称保持一致"},model:{value:t.formValidate.task_name,callback:function(e){t.$set(t.formValidate,"task_name","string"==typeof e?e.trim():e)},expression:"formValidate.task_name"}})],1),t._v(" "),r("FormItem",{attrs:{label:"任务类型",prop:"task_type"}},[r("Select",{model:{value:t.formValidate.task_type,callback:function(e){t.$set(t.formValidate,"task_type",e)},expression:"formValidate.task_type"}},[r("Option",{attrs:{value:"iwork_quartz"}},[t._v("iwork_quartz")])],1)],1),t._v(" "),r("FormItem",{attrs:{label:"cron 表达式",prop:"cron_str"}},[r("Input",{attrs:{placeholder:"请输入 cron 表达式"},model:{value:t.formValidate.cron_str,callback:function(e){t.$set(t.formValidate,"cron_str","string"==typeof e?e.trim():e)},expression:"formValidate.cron_str"}})],1),t._v(" "),r("FormItem",[r("Button",{staticStyle:{"margin-right":"6px"},attrs:{type:"success"},on:{click:function(e){t.handleSubmit("formValidate")}}},[t._v("提交")]),t._v(" "),r("Button",{staticStyle:{"margin-right":"6px"},attrs:{type:"warning"},on:{click:function(e){t.handleReset("formValidate")}}},[t._v("重置")])],1)],1)],1)},staticRenderFns:[]};var f=r("VU/8")(h,d,!1,function(t){r("N1/l")},"data-v-112301e1",null).exports,p={name:"QuartzList",components:{ISimpleLeftRightRow:c.default,ISimpleSearch:u.default,QuartzEdit:f},data:function(){var t=this;return{current_page:1,total:0,offset:10,search:"",quartzs:[],columns1:[{title:"任务名称",key:"task_name",width:200},{title:"任务类型",key:"task_type",width:120},{title:"cron表达式",key:"cron_str",width:100},{title:"启用状态",key:"enable",width:100},{title:"最后修改人",key:"last_updated_by",width:180},{title:"最后修改时间",key:"last_updated_time",width:180,render:function(t,e){return t("div",Object(o.e)(new Date(e.row.last_updated_time),"yyyy-MM-dd hh:mm"))}},{title:"操作",key:"operate",width:300,fixed:"right",render:function(e,r){return e("div",[e("Button",{props:{type:"info",size:"small"},style:{marginRight:"5px"},on:{click:function(){t.$refs.quartzEdit.initData(Object(o.c)(t.quartzs[r.index]))}}},"编辑"),e("Button",{props:{type:"success",size:"small"},style:{marginRight:"5px"},on:{click:function(){t.toggleQuartzStatus(t.quartzs[r.index].task_name,"start")}}},"启用"),e("Button",{props:{type:"error",size:"small"},style:{marginRight:"5px"},on:{click:function(){t.toggleQuartzStatus(t.quartzs[r.index].task_name,"stop")}}},"停用"),e("Button",{props:{type:"warning",size:"small"},style:{marginRight:"5px"},on:{click:function(){t.toggleQuartzStatus(t.quartzs[r.index].task_name,"delete")}}},"删除"),e("Button",{props:{type:"info",size:"small"},style:{marginRight:"5px"},on:{click:(a=i()(s.a.mark(function e(){var r;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(l._3)(t.$route.query.work_id);case 2:"SUCCESS"==(r=e.sent).status&&t.$router.push({path:"/iwork/runLogList",query:{work_id:r.work.id}});case 4:case"end":return e.stop()}},e,t)})),function(){return a.apply(this,arguments)})}},"调度记录")]);var a}}]}},methods:{refreshQuartzList:function(){var t=i()(s.a.mark(function t(){var e;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(l.Z)(this.offset,this.current_page,this.search);case 2:"SUCCESS"==(e=t.sent).status&&(this.quartzs=e.quartzs,this.total=e.paginator.totalcount);case 4:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),handleChange:function(t){this.current_page=t,this.refreshQuartzList()},handlePageSizeChange:function(t){this.offset=t,this.refreshQuartzList()},handleSearch:function(t){this.offset=10,this.current_page=1,this.search=t,this.refreshQuartzList()},toggleQuartzStatus:function(){var t=i()(s.a.mark(function t(e,r){var a;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(l._9)(e,r);case 2:"SUCCESS"==(a=t.sent).status?this.refreshQuartzList():this.$Message.error(a.errorMsg);case 4:case"end":return t.stop()}},t,this)}));return function(e,r){return t.apply(this,arguments)}}()},mounted:function(){this.refreshQuartzList()}},m={render:function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticStyle:{margin:"10px"}},[r("ISimpleLeftRightRow",{staticStyle:{"margin-bottom":"10px","margin-right":"10px"}},[r("QuartzEdit",{ref:"quartzEdit",attrs:{slot:"left"},on:{handleSuccess:t.refreshQuartzList},slot:"left"}),t._v(" "),r("ISimpleSearch",{attrs:{slot:"right"},on:{handleSimpleSearch:t.handleSearch},slot:"right"})],1),t._v(" "),r("Table",{attrs:{border:"",columns:t.columns1,data:t.quartzs,size:"small"}}),t._v(" "),r("Page",{attrs:{total:t.total,"page-size":t.offset,"show-total":"","show-sizer":"",styles:{"text-align":"center","margin-top":"10px"}},on:{"on-change":t.handleChange,"on-page-size-change":t.handlePageSizeChange}}),t._v(" "),r("h3",[t._v("cron举例说明")]),t._v(" "),t._m(0),t._v(" "),t._m(1),t._v(" "),t._m(2),t._v(" "),t._m(3),t._v(" "),t._m(4),t._v(" "),t._m(5),t._v(" "),t._m(6)],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("每隔5秒执行一次："),e("span",{staticStyle:{color:"red"}},[this._v("*/5 * * * * ?")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("每隔1分钟执行一次："),e("span",{staticStyle:{color:"red"}},[this._v("0 */1 * * * ?")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("每天23点执行一次："),e("span",{staticStyle:{color:"red"}},[this._v("0 0 23 * * ?")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("每天凌晨1点执行一次："),e("span",{staticStyle:{color:"red"}},[this._v("0 0 1 * * ?")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("每月1号凌晨1点执行一次："),e("span",{staticStyle:{color:"red"}},[this._v("0 0 1 1 * ?")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("在26分、29分、33分执行一次："),e("span",{staticStyle:{color:"red"}},[this._v("0 26,29,33 * * * ?")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("每天的0点、13点、18点、21点都执行一次："),e("span",{staticStyle:{color:"red"}},[this._v("0 0 0,13,18,21 * * ?")])])}]};var _=r("VU/8")(p,m,!1,function(t){r("6QlG")},"data-v-789e8cc7",null);e.default=_.exports}});
//# sourceMappingURL=8.fa5c38caf15999d57ada.js.map